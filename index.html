<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>API Upload</title>
  </head>
  <body>
    <form>
      <label for="apikey">API Key:</label>
      <input type="text" id="apikey" name="apikey">
      <br>
      <label for="url">Video URL:</label>
      <input type="text" id="url" name="url">
      <br>
      <label for="public">Public:</label>
      <input type="checkbox" id="public" name="public">
      <br>
      <label for="adult">Adult:</label>
      <input type="checkbox" id="adult" name="adult">
      <br>
      <input type="checkbox" id="remember" name="remember" checked>
      <label for="remember">Remember API Key</label>
      <br>
      <button type="button" onclick="submitForm()">Submit</button>
    </form>
    <div id="result"></div>
    <script>
      let requestSent = false;
      
      function submitForm() {
        if (requestSent) {
          return;
        }
        
        const apikey = document.getElementById("apikey").value;
        const url = document.getElementById("url").value;
        const remember = document.getElementById("remember").checked;
        const publicFlag = document.getElementById("public").checked ? 1 : 0;
        const adultFlag = document.getElementById("adult").checked ? 1 : 0;
        
        if (remember) {
          setCookie("apikey", apikey, 365);
        }
        
        if (apikey && url) {
          requestSent = true;
          
          fetch(`https://api.streamhide.com/api/upload/url?key=${apikey}&url=${url}&file_public=${publicFlag}&file_adult=${adultFlag}`)
            .then(response => response.json())
            .then(data => {
              const filecode = data.result.filecode;
              document.getElementById("result").innerHTML = `<p>File uploaded successfully. File code: ${filecode}</p>`;
              requestSent = false;
            })
            .catch(error => {
              document.getElementById("result").innerHTML = "<p>Failed to upload file. Please check your API key and URL.</p>";
              requestSent = false;
            });
        } else {
          document.getElementById("result").innerHTML = "<p>Please fill out all required fields.</p>";
        }
      }
      
      function setCookie(name, value, days) {
        const expires = new Date(Date.now() + days * 24 * 60 * 60 * 1000).toUTCString();
        document.cookie = `${name}=${encodeURIComponent(value)}; expires=${expires}; path=/`;
      }
    </script>
  </body>
</html>
